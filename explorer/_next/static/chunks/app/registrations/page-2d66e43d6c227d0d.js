(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{3195:function(e,r,t){Promise.resolve().then(t.bind(t,2234))},2234:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return k}});var n=t(7437),s=t(4033),i=t(2265),a=t(3956),l=t(8530),c=t(7744),d=t(4434),o=t(8597),h=t(9639),u=t(3839),g=t(1387),x=t(6704),f=t(105),j=t(7153),b=t(6028),v=t(5890),p=t(3316),m=t(9882);function k(){var e,r;let t=(0,s.useSearchParams)(),[x,k]=(0,i.useState)(!0),[Z,y]=(0,i.useState)(void 0),[S,w]=(0,i.useState)(void 0),[N,M]=(0,i.useState)(void 0),[C,_]=(0,i.useState)(void 0),[E,A]=(0,i.useState)(void 0),[W,L]=(0,i.useState)([]),[R,T]=(0,i.useState)({stakesBreakdown:{},signersWeigth:{}});(0,i.useEffect)(()=>{let e;let r=t.get(j.W),n=Number(t.get("epoch"));w(r),M(n),(0,a.checkUrl)(r)?Number.isInteger(n)||(e="invalidEpoch"):e="invalidAggregatorUrl",void 0===e?(fetch("".concat(r,"/signers/registered/").concat(n)).then(e=>200===e.status?e.json():{}).then(e=>{_(e.signing_at),L(e.registrations),T({stakesBreakdown:function(e){let r=e=>e/1e12,t=(null!=e?e:[]).map(e=>r(e.stake));return{labels:["< 1M₳","≥ 1M₳ < 10M₳","≥ 10M₳ < 25M₳","≥ 25M₳ < 50M₳","≥ 50M₳ < 75M₳","≥ 75M₳ < 100M₳","≥ 100M₳"],datasets:[{label:"Number of signers",data:[t.filter(e=>e<1).length,t.filter(e=>e>=1&&e<10).length,t.filter(e=>e>=10&&e<25).length,t.filter(e=>e>=25&&e<50).length,t.filter(e=>e>=50&&e<75).length,t.filter(e=>e>=75&&e<100).length,t.filter(e=>e>100).length]}]}}(e.registrations),signersWeigth:function(e){let r=null!=e?e:[];return{labels:r.map(e=>e.party_id),datasets:[{label:"Stake (₳)",data:r.map(e=>(0,a.toAda)(e.stake))}]}}(e.registrations)}),k(!1)}).catch(e=>{_(void 0),L([]),k(!1),console.error("Fetch registrations error:",e)}),fetch("".concat(r,"/epoch-settings")).then(e=>200===e.status?e.json():{}).then(e=>A(null==e?void 0:e.epoch)).catch(e=>{A(void 0),console.error("Fetch current epoch in epoch-settings error:",e)})):y(e)},[t]);let U=(0,i.useCallback)(e=>{let r=new URLSearchParams;return r.set("aggregator",S),r.set("epoch",e),"/registrations?".concat(r.toString())},[S]),D=U(N-1),P=U(E),B=U(N+1);if(void 0!==Z){let e="";switch(Z){case"invalidEpoch":e="The given epoch isn't an integer, please correct it and try again.";break;case"invalidAggregatorUrl":e="The given aggregator isn't a valid url, please correct it and try again.";break;default:e="Something went wrong"}return(0,n.jsxs)(u.Z,{gap:3,children:[(0,n.jsx)("h2",{children:"Registrations"}),(0,n.jsxs)(l.Z,{variant:"danger",children:[(0,n.jsx)(l.Z.Heading,{children:"Oh snap! You got an error!"}),(0,n.jsx)("p",{children:e})]})]})}return(0,n.jsxs)(u.Z,{gap:3,children:[(0,n.jsxs)("h2",{children:["Registrations "," ",(0,n.jsx)(p.Z,{href:"".concat(S,"/signers/registered/").concat(N),variant:"outline-light",size:"sm"})]}),(0,n.jsx)(o.Z,{children:(0,n.jsx)(g.Z,{children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("strong",{children:"Aggregator:"})}),(0,n.jsx)("td",{children:S})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("strong",{children:"Registration epoch:"})}),(0,n.jsx)("td",{children:N})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("strong",{children:"Signing at epoch:"})}),(0,n.jsx)("td",{children:null!=C?C:"?"})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("strong",{children:"Number of signers:"})}),(0,n.jsx)("td",{children:null!==(e=null==W?void 0:W.length)&&void 0!==e?e:0})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("strong",{children:"Total stakes:"})}),(0,n.jsx)("td",{children:(0,n.jsx)(v.Z,{lovelace:null!==(r=null==W?void 0:W.reduce((e,r)=>e+r.stake,0))&&void 0!==r?r:0})})]})]})})}),(0,n.jsx)(o.Z,{children:(0,n.jsx)("div",{children:Number.isInteger(N)&&(0,n.jsxs)(c.Z,{children:[(0,n.jsxs)(b.Z,{href:D,children:["Previous Epoch (",N-1,")"]}),(0,n.jsxs)(b.Z,{href:P,disabled:void 0===E||E===N,children:["Current Epoch (",E,")"]}),(0,n.jsxs)(b.Z,{href:B,disabled:E<=N,children:["Next Epoch (",N+1,")"]})]})})}),x?(0,n.jsx)(h.Z,{animation:"grow"}):void 0===W||0===W.length?(0,n.jsxs)(l.Z,{variant:"info",children:[(0,n.jsxs)(l.Z.Heading,{children:["No registrations for epoch ",N]}),(0,n.jsx)("p",{children:E===N?"The aggregator did not receive registrations yet for the current epoch.":E<N?"The epoch is in the future":"The aggregator may have pruned old registrations or wasn't running at this epoch."})]}):(0,n.jsxs)(o.Z,{children:[(0,n.jsxs)(d.Z,{xs:12,sm:12,md:7,children:[(0,n.jsx)("h3",{children:"Signers"}),(0,n.jsxs)(g.Z,{responsive:!0,striped:!0,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"#"}),(0,n.jsx)("th",{children:"Party id"}),(0,n.jsx)("th",{style:{textAlign:"end"},children:"Stake"})]})}),(0,n.jsx)("tbody",{children:W.map((e,r)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:r}),(0,n.jsxs)("td",{children:[(0,n.jsx)(m.Z,{tooltip:"Verified Signer"})," ",e.party_id]}),(0,n.jsx)("td",{style:{textAlign:"end"},children:(0,n.jsx)(v.Z,{lovelace:e.stake})})]},e.party_id))})]})]}),(0,n.jsx)(d.Z,{xs:12,sm:12,md:5,children:(0,n.jsxs)(u.Z,{gap:3,children:[(0,n.jsx)("h3",{children:"Stakes breakdown"}),(0,n.jsx)(f.$Q,{data:R.stakesBreakdown}),(0,n.jsx)("h3",{children:"Signers weight"}),(0,n.jsx)(f.by,{data:R.signersWeigth})]})})]})]})}x.kL.register(x.qi,x.uw,x.f$,x.ZL,x.Dx,x.u,x.De),(0,a.setChartJsDefaults)(x.kL)},6028:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});var n=t(7437);t(2265);var s=t(1396),i=t.n(s);function a(e){let{href:r,children:t,className:s,disabled:a,...l}=e;return!0===a?s="".concat(s," disabled"):a=!1,(0,n.jsx)(i(),{href:r,"aria-disabled":a,className:"btn btn-primary link-underline-opacity-0 link-light ".concat(s),...l,children:t})}},3316:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var n=t(7437);t(2265);var s=t(6716),i=t(7322),a=t(7800);function l(e){return(0,n.jsx)(i.Z,{overlay:(0,n.jsx)(a.Z,{children:"Raw JSON"}),children:(0,n.jsx)(s.Z,{variant:"outline-secondary",target:"_blank",...e,children:(0,n.jsx)("i",{className:"bi bi-filetype-json",style:{color:"black"}})})})}},5890:function(e,r,t){"use strict";t.d(r,{Z:function(){return l}});var n=t(7437);t(2265);var s=t(7322),i=t(7800),a=t(3956);function l(e){let{lovelace:r}=e;return(0,n.jsx)(s.Z,{overlay:(0,n.jsxs)(i.Z,{children:[(0,a.formatCurrency)((0,a.toAda)(r),20),"₳"]}),children:(0,n.jsx)("span",{children:(0,a.formatStake)(r)})})}},9882:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});var n=t(7437);t(2265);var s=t(7322),i=t(7800);function a(e){return(0,n.jsx)(s.Z,{overlay:(0,n.jsx)(i.Z,{children:e.tooltip}),children:(0,n.jsx)("a",{href:"#",className:"badge bg-success",children:(0,n.jsx)("i",{className:"bi bi-shield-lock"})})})}},7153:function(e,r,t){"use strict";t.d(r,{W:function(){return n}});let n="aggregator"},3956:function(e){"use strict";let r=e=>e/1e6,t=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toLocaleString(void 0,{maximumFractionDigits:r})};e.exports={checkUrl:function(e){try{return new URL(e),!0}catch(e){return!1}},formatStake:function(e){let n=r(e),s=[{suffix:"B",value:1e9},{suffix:"M",value:1e6},{suffix:"K",value:1e3},{suffix:"",value:1}].find(e=>Math.abs(n)>=e.value-.001);return s?"".concat(t(n/s.value)).concat(s.suffix,"₳"):"".concat(t(n),"₳")},setChartJsDefaults:function(e){let r=["rgba(255, 99, 132, 0.2)","rgba(255, 159, 64, 0.2)","rgba(255, 205, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(54, 162, 235, 0.2)","rgba(153, 102, 255, 0.2)","rgba(201, 203, 207, 0.2)"],t=["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(153, 102, 255)","rgb(201, 203, 207)"];e.defaults.plugins.legend.display=!1,e.defaults.elements.arc.backgroundColor=r,e.defaults.elements.arc.borderColor=t,e.defaults.elements.arc.borderWidth=1,e.defaults.elements.bar.backgroundColor=r,e.defaults.elements.bar.borderColor=t,e.defaults.elements.bar.borderWidth=1},toAda:r,formatCurrency:t}}},function(e){e.O(0,[674,807,369,786,971,596,744],function(){return e(e.s=3195)}),_N_E=e.O()}]);